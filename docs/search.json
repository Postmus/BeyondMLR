[
  {
    "objectID": "Assignments/Week 5/Assignment_week_5.html",
    "href": "Assignments/Week 5/Assignment_week_5.html",
    "title": "Assignment Week 5",
    "section": "",
    "text": "In this assignment, you will analyze multilevel data to describe the development of students’ English and Mathematics test scores over time. The data come from the Junior School Project (Mortimore et al.), which examines factors influencing academic progress in junior schools. There are over 1000 students measured over three school years with 3236 records included in this dataset.\nThis dataset was sourced from the data library of the centre for Multilevel Modelling, University of Bristol."
  },
  {
    "objectID": "Assignments/Week 5/Assignment_week_5.html#introduction",
    "href": "Assignments/Week 5/Assignment_week_5.html#introduction",
    "title": "Assignment Week 5",
    "section": "",
    "text": "In this assignment, you will analyze multilevel data to describe the development of students’ English and Mathematics test scores over time. The data come from the Junior School Project (Mortimore et al.), which examines factors influencing academic progress in junior schools. There are over 1000 students measured over three school years with 3236 records included in this dataset.\nThis dataset was sourced from the data library of the centre for Multilevel Modelling, University of Bristol."
  },
  {
    "objectID": "Assignments/Week 5/Assignment_week_5.html#dataset-description",
    "href": "Assignments/Week 5/Assignment_week_5.html#dataset-description",
    "title": "Assignment Week 5",
    "section": "Dataset description",
    "text": "Dataset description\nThe dataset consists of the following variables:\n\nSchool: School ID.\nStudent.ID: Student ID.\nGender: A categorical variable representing the gender of the student\nJunior.school.year: Year of the study (0, 1, or 2).\nEnglish.test: English test score in year 1.\nMathematics.test: Mathematics test score in year 1.\n\nThe dataset can be downloaded from the link provided in the Downloads section below. When reading the dataset into R, ensure that the Gender variable is correctly encoded as a factor."
  },
  {
    "objectID": "Assignments/Week 5/Assignment_week_5.html#objectives",
    "href": "Assignments/Week 5/Assignment_week_5.html#objectives",
    "title": "Assignment Week 5",
    "section": "Objectives",
    "text": "Objectives\nYour objectives are to:\n\nDevelop an appropriate model to describe the development of students’ English test scores over time\n\nInclude random intercepts to account for the nesting of longitudinal measurements within students and the subsequent nesting of students within schools\nExplore systematic differences in the mean “growth curves” of English test scores over time between boys and girls\nConsider interaction terms such as Gender * Junior.school.year to explore gender-specific trends\n\nDevelop an appropriate model to describe the development of students’ Mathematics test scores over time\n\nInclude random intercepts to account for the nesting of longitudinal measurements within students and the subsequent nesting of students within schools\nExplore systematic differences in the mean “growth curves” of Mathematics test scores over time between boys and girls\nConsider interaction terms such as Gender * Junior.school.year to explore gender-specific trends"
  },
  {
    "objectID": "Assignments/Week 5/Assignment_week_5.html#requirements-for-the-report",
    "href": "Assignments/Week 5/Assignment_week_5.html#requirements-for-the-report",
    "title": "Assignment Week 5",
    "section": "Requirements for the report",
    "text": "Requirements for the report\nYour report should clearly explain:\n\nThe reasoning behind your choice of model structure, supported by the results of the exploratory data analysis\nThe interpretation of key model parameters in the context of the research questions\nAny limitations or assumptions affecting your analysis\n\nSubmit both the Quarto source file (.qmd) and the rendered HTML file.\n\n\n\n\n\n\nTip\n\n\n\nThe time variable Junior.school.year is represented as a continuous variable in the dataset. However, you may transform it into a categorical variable in your analysis if you find it more appropriate. For example, you could treat it as a factor with three levels (0, 1, and 2) to represent the three years of the study. This transformation may help you interpret the results more easily.\n\n\n\n\n\n\n\n\nTip\n\n\n\nWhile conceptually it is possible to also include a random slope for the time variable in your models, you are not required to do so for this assignment (depending on the coding of the time variable, there are either not sufficient degrees of freedom to fit this model or you may run into convergence/boundary fit issues. You may therefore focus on random intercepts to keep the analysis manageable."
  },
  {
    "objectID": "Assignments/Week 5/Assignment_week_5.html#downloads",
    "href": "Assignments/Week 5/Assignment_week_5.html#downloads",
    "title": "Assignment Week 5",
    "section": "Downloads",
    "text": "Downloads\nDownload dataset"
  },
  {
    "objectID": "Assignments/Week 3/Assignment_week_3.html",
    "href": "Assignments/Week 3/Assignment_week_3.html",
    "title": "Assignment Week 3: Multilevel Analysis of School Effectiveness",
    "section": "",
    "text": "In this assignment, you will analyze a dataset collected by the Inner London Education Authority (ILEA) to examine the effectiveness of schools. The dataset consists of examination records of 15,362 students from 140 secondary schools over the years 1985, 1986, and 1987. This dataset was sourced from the data library of the Centre for Multilevel Modelling at the University of Bristol."
  },
  {
    "objectID": "Assignments/Week 3/Assignment_week_3.html#introduction",
    "href": "Assignments/Week 3/Assignment_week_3.html#introduction",
    "title": "Assignment Week 3: Multilevel Analysis of School Effectiveness",
    "section": "",
    "text": "In this assignment, you will analyze a dataset collected by the Inner London Education Authority (ILEA) to examine the effectiveness of schools. The dataset consists of examination records of 15,362 students from 140 secondary schools over the years 1985, 1986, and 1987. This dataset was sourced from the data library of the Centre for Multilevel Modelling at the University of Bristol."
  },
  {
    "objectID": "Assignments/Week 3/Assignment_week_3.html#dataset-description",
    "href": "Assignments/Week 3/Assignment_week_3.html#dataset-description",
    "title": "Assignment Week 3: Multilevel Analysis of School Effectiveness",
    "section": "Dataset Description",
    "text": "Dataset Description\nThe dataset consists of the following variables:\n\nSchool: A numeric variable representing the school identifier (codes 1 to 139)\nExamScore: A numeric variable representing the exam score of each student\nPercentFSM: The percentage of students in the school eligible for free school meals (an indicator of socioeconomic status)\nGender: A categorical variable representing the gender of the student\nVRBand: The verbal reasoning band of the student (VR1, VR2, or VR3). VR band is an indicator of the student’s assessed ability level, with VR1 typically representing the highest ability group, VR2 representing intermediate ability, and VR3 representing lower ability.\nSchoolDenomination: The denomination of the school (Maintained, Church of England, Roman Catholic)"
  },
  {
    "objectID": "Assignments/Week 3/Assignment_week_3.html#objective",
    "href": "Assignments/Week 3/Assignment_week_3.html#objective",
    "title": "Assignment Week 3: Multilevel Analysis of School Effectiveness",
    "section": "Objective",
    "text": "Objective\nYour goals are to determine:\n\nHow much of the variability in exam scores can be attributed to:\n\nDifferences between students\nDifferences between schools\n\nWhether individual-level factors (e.g., Gender, VRBand) significantly influence student exam scores\nWhether school-level factors (e.g., PercentFSM) significantly influence student exam scores"
  },
  {
    "objectID": "Assignments/Week 3/Assignment_week_3.html#steps-to-complete-the-analysis",
    "href": "Assignments/Week 3/Assignment_week_3.html#steps-to-complete-the-analysis",
    "title": "Assignment Week 3: Multilevel Analysis of School Effectiveness",
    "section": "Steps to Complete the Analysis",
    "text": "Steps to Complete the Analysis\n\nLoad the Dataset\nDownload the dataset (see link in the Downloads section below) and read it into R. Make sure all character variables are correctly encoded as factors.\n\n\nExploratory Data Analysis (EDA):\n\nVisualize the nesting structure of the data (i.e., number of students per school)\nExplore the distribution of the outcome variable (ExamScore)\n\n\n\nMulti-Level Modeling\n\nStart by fitting a null model (i.e., a random intercept model without any predictors) to partition the variance in exam scores between students and schools. Assess how much of the variability in exam scores is due to differences between students and schools.\nNext, add individual-level variables (Gender, VRBand) to the model to explore how these factors influence exam scores.\nAfter that, add context-level variables (e.g., PercentFSM) to your model to understand how factors at the school level contribute to differences in exam scores.\nFinally, explore potential cross-level interactions between individual-level and context-level variables.\n\n\n\nInterpret the Results\nInterpret the findings from your analysis, focusing on the variance components and the effects of individual-level and context-level variables."
  },
  {
    "objectID": "Assignments/Week 3/Assignment_week_3.html#requirements-for-the-report",
    "href": "Assignments/Week 3/Assignment_week_3.html#requirements-for-the-report",
    "title": "Assignment Week 3: Multilevel Analysis of School Effectiveness",
    "section": "Requirements for the Report",
    "text": "Requirements for the Report\nSubmit both the Quarto source file (.qmd) and the rendered HTML file. The HTML file should be rendered with code visibility enabled (echo = TRUE)."
  },
  {
    "objectID": "Assignments/Week 3/Assignment_week_3.html#downloads",
    "href": "Assignments/Week 3/Assignment_week_3.html#downloads",
    "title": "Assignment Week 3: Multilevel Analysis of School Effectiveness",
    "section": "Downloads",
    "text": "Downloads\nDownload dataset"
  },
  {
    "objectID": "Assignments/Week 1/Assignment_week_1.html",
    "href": "Assignments/Week 1/Assignment_week_1.html",
    "title": "Assignment week 1: Effect of Rehabilitation Programs on Mobility in Stroke Patients",
    "section": "",
    "text": "In this assignment, you will analyze a dataset that examines the effect of different rehabilitation programs on the mobility of stroke patients. The dataset includes mobility improvement measurements taken using the 6-Minute Walk Test (6MWT), a standard assessment to evaluate physical mobility and endurance.\nPatients in the study were randomly assigned to one of three rehabilitation programs:\n\nControl: Standard physical therapy.\nRobotic-Assisted Therapy: Rehabilitation involving robotic devices designed to support movement.\nAquatic Therapy: Water-based exercises aimed at improving mobility with reduced joint stress."
  },
  {
    "objectID": "Assignments/Week 1/Assignment_week_1.html#introduction",
    "href": "Assignments/Week 1/Assignment_week_1.html#introduction",
    "title": "Assignment week 1: Effect of Rehabilitation Programs on Mobility in Stroke Patients",
    "section": "",
    "text": "In this assignment, you will analyze a dataset that examines the effect of different rehabilitation programs on the mobility of stroke patients. The dataset includes mobility improvement measurements taken using the 6-Minute Walk Test (6MWT), a standard assessment to evaluate physical mobility and endurance.\nPatients in the study were randomly assigned to one of three rehabilitation programs:\n\nControl: Standard physical therapy.\nRobotic-Assisted Therapy: Rehabilitation involving robotic devices designed to support movement.\nAquatic Therapy: Water-based exercises aimed at improving mobility with reduced joint stress."
  },
  {
    "objectID": "Assignments/Week 1/Assignment_week_1.html#objective",
    "href": "Assignments/Week 1/Assignment_week_1.html#objective",
    "title": "Assignment week 1: Effect of Rehabilitation Programs on Mobility in Stroke Patients",
    "section": "Objective",
    "text": "Objective\nYour objective is to determine whether there is a statistically significant difference in mobility improvement among the three rehabilitation groups. To complete this analysis, follow these steps:\n\nExplore the Data: Perform an exploratory data analysis (EDA) to understand the distribution of mobility improvements across treatment groups.\nFit a One-Way ANOVA Model: Fit a one-way ANOVA model to test for overall group differences.\nPost-Hoc Comparisons: If you identify significant group differences, calculate estimated marginal means and conduct post-hoc comparisons to determine which groups differ.\nModel Diagnostics: Conduct diagnostic tests and visualizations to evaluate model assumptions, including homoscedasticity and normality of residuals."
  },
  {
    "objectID": "Assignments/Week 1/Assignment_week_1.html#requirements-for-the-report",
    "href": "Assignments/Week 1/Assignment_week_1.html#requirements-for-the-report",
    "title": "Assignment week 1: Effect of Rehabilitation Programs on Mobility in Stroke Patients",
    "section": "Requirements for the Report",
    "text": "Requirements for the Report\nSubmit both the Quarto source file (.qmd) and the rendered HTML file. The quarto source file should include all R code and annotations, and the html file should be rendered with code visibility enabled (echo: true, which is the default setting used in the template). The Quarto file in the downloads section below provides a template that you can use for this assignment."
  },
  {
    "objectID": "Assignments/Week 1/Assignment_week_1.html#downloads",
    "href": "Assignments/Week 1/Assignment_week_1.html#downloads",
    "title": "Assignment week 1: Effect of Rehabilitation Programs on Mobility in Stroke Patients",
    "section": "Downloads",
    "text": "Downloads\n\nDownload dataset\nDownload Quarto Template"
  },
  {
    "objectID": "BLR_lab_FE_oneway.html",
    "href": "BLR_lab_FE_oneway.html",
    "title": "Beyond MLR Lab 1: One-way ANOVA",
    "section": "",
    "text": "NotePreliminary setup\n\n\n\nIn this lab, we will use the R packages ggplot2, dplyr, and emmeans. You can use the script below to automatically install and load them using the pacman package.\n\n# Check whether pacman is available and install if needed\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\n# Use pacman to install (if needed) and load the required packages\npacman::p_load(dplyr, ggplot2, emmeans, lmerTest)"
  },
  {
    "objectID": "BLR_lab_FE_oneway.html#exploratory-data-analysis",
    "href": "BLR_lab_FE_oneway.html#exploratory-data-analysis",
    "title": "Beyond MLR Lab 1: One-way ANOVA",
    "section": "Exploratory Data Analysis",
    "text": "Exploratory Data Analysis\nTo understand the distribution of blood pressure reduction across treatment groups, we start by creating a boxplot:\n\n# Visualizing the results\nggplot(data_oneway, aes(x = Treatment, y = BP_change, fill = Treatment)) +\n  geom_boxplot() +\n  labs(title = NULL,\n       x = \"Treatment\", y = \"Change in SBP (mm Hg)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nWe also calculate some summary statistics:\n\n# Generating summary statistics\nsummary_stats &lt;- data_oneway |&gt;\n  group_by(Treatment) |&gt;\n  summarise(\n    Mean_BP_change = mean(BP_change),\n    SD_BP_change = sd(BP_change)\n  )\nsummary_stats\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nHow do the mean changes in SBP compare among the treatment groups?"
  },
  {
    "objectID": "BLR_lab_FE_oneway.html#performing-a-one-way-anova",
    "href": "BLR_lab_FE_oneway.html#performing-a-one-way-anova",
    "title": "Beyond MLR Lab 1: One-way ANOVA",
    "section": "Performing a One-Way ANOVA",
    "text": "Performing a One-Way ANOVA\n\nModel Specification\nUsing effects coding, the one-way Analysis of Variance (ANOVA) model can be specified as:\n\\[\nY_{ij} = \\mu + \\tau_i + \\epsilon_{ij}\n\\]\nwhere:\n\n\\(Y_{ij}\\): The change in SBP for the \\(j\\)-th patient in the \\(i\\)-th treatment group.\n\\(\\mu\\): The mean change in SBP across all treatment groups.\n\\(\\tau_i\\): The effect of the \\(i\\)-th treatment (deviation from the overall mean).\n\\(\\epsilon_{ij}\\): The residual error term, assumed to be independent and normally distributed with mean zero and constant variance.\n\n\n\n\n\n\n\nNoteCoding schemes for categorical variables\n\n\n\nIn regression models, categorical variables are represented using coding schemes that allow their inclusion as explanatory variables. While dummy coding is widely used in multiple linear regression models, effects coding is more common in ANOVA models as it enables interpretation of group differences relative to the grand mean rather than a single reference category. This interpretative difference makes effects coding particularly useful for examining group-level effects in experimental designs.\nTo change the coding scheme globally to effects coding:\n\n# Set effects coding as the default coding scheme for unordered (nominal) factors\n# Keep the default polynomial coding for ordered (ordinal) factors\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))\n\nTo reset the coding scheme to the default dummy coding:\n\n# Reset the coding scheme for unordered factors to dummy coding\noptions(contrasts = c(\"contr.treatment\", \"contr.poly\"))\n\n\n\n\n\nModel Estimation\nWe can fit the one-way ANOVA model using the lm() function:\n\noptions(contrasts = c(\"contr.sum\", \"contr.poly\")) # Effects coding\ncontrasts(data_oneway$Treatment) # Print contrast matrix for Treatment\n\n# Fit the one-way ANOVA model\nmodel_oneway &lt;- lm(BP_change ~ Treatment, data = data_oneway)\nsummary(model_oneway)\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nHow do the estimated coefficients relate to the group means?\n\n\n\n\nANOVA Table\nTo test whether the effect of treatment is statistically significant, we use the anova() function to obtain the ANOVA table:\n\n# ANOVA table\nanova_results &lt;- anova(model_oneway)\nanova_results\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nWhat does the F-test tell us about the treatment effect?\n\n\n\n\nEstimated Marginal Means\nEstimated marginal means, also known as least-squares means, are model-based means that represent the predicted (or expected) response at each level of a factor, averaged over the levels of other variables in the model.\nIn the context of a one-way ANOVA, where there is only one factor (e.g., treatment group), the estimated marginal means are equal to the observed group means. In more complex models with multiple factors, estimated marginal means provide predicted group means that are averaged over the levels of these additional factors. For example, in a model with both treatment and age as factors, the estimated marginal means for the treatment groups show the treatment means averaged over age, illustrating what these group means are expected to be at specific values of age (or averaged over a grid of age values).\nWe can calculate the estimated marginal means using the emmeans() function from the emmeans package:\n\n# Obtain estimated marginal means\nemms &lt;- emmeans(model_oneway, ~ Treatment)\nemms  # displays EMMs with standard errors and 95% confidence intervals\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nHow do the estimated marginal means compare to the observed group means calculated during the exploratory data analysis?\n\n\n\n\nPairwise comparisons\nSince we found a significant treatment effect, we will conduct pairwise comparisons of the estimated marginal means to identify which specific treatment groups differ significantly from one another. We perform these pairwise comparisons using the pairs() function from the emmeans package. To account for the increased risk of Type I error due to multiple comparisons, we apply the Bonferroni correction to adjust the p-values, ensuring that the overall significance level remains controlled.\n\n# Performing post-hoc analysis with emmeans\npairs(emms, adjust=\"Bonferroni\")\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nBased on the results of the pairwise comparisons, which treatment groups differ significantly?\n\n\n\n\nModel Diagnostics\nTo assess the adequacy of the fitted model, we create two diagnostic plots:\n\nResiduals vs Fitted Plot: Used to assess homoscedasticity (constant variance) for the errors. A random scatter of residuals around zero indicates equal variance.\nNormal Q-Q Plot: Used to assess normality of the errors. Residuals following the reference line suggest normally distributed errors.\n\n\n# Residuals vs Fitted\nplot(model_oneway, which = 1, main = \"Residuals vs Fitted\")\n\n# Normal Q-Q\nplot(model_oneway, which = 2, main = \"Normal Q-Q\")\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nDo the diagnostic plots suggest any violations of the model assumptions?\n\n\n\n\nReporting\nA one-way ANOVA showed a statistically significant effect of treatment on the change in systolic blood pressure, F(2, 117) = 43.86, p &lt; 0.001. Estimated marginal means (95% CI) were -20.1 (-22.9, -17.2) mm Hg for Drug A, -4.9 (-7.8, -2.1) mm Hg for Drug B, and -1.6 (-4.4, 1.3) mm Hg for the Control group. Pairwise comparisons (Bonferroni-adjusted) indicated statistically significant differences between Drug A and both Drug B (p &lt; 0.001) and the Control group (p &lt; 0.001), but not between Drug B and the Control group (p = 0.291)."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R labs for the Beyond MLR course",
    "section": "",
    "text": "This website hosts the R labs for the beyond MLR course. You can navigate between the different labs using the menu above."
  },
  {
    "objectID": "BLR_lab_randomized_block.html",
    "href": "BLR_lab_randomized_block.html",
    "title": "Beyond MLR Lab 2: Randomized Block Designs",
    "section": "",
    "text": "NotePreliminary setup\n\n\n\nIn this lab, we will use the R packages ggplot2, dplyr, emmeans, and lmerTest. You can use the script below to automatically install and load them using the pacman package.\n\n# Check whether pacman is available and install if needed\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\n# Use pacman to install (if needed) and load the required packages\npacman::p_load(dplyr, ggplot2, emmeans, lmerTest)"
  },
  {
    "objectID": "BLR_lab_randomized_block.html#exploratory-data-analysis",
    "href": "BLR_lab_randomized_block.html#exploratory-data-analysis",
    "title": "Beyond MLR Lab 2: Randomized Block Designs",
    "section": "Exploratory Data Analysis",
    "text": "Exploratory Data Analysis\nTo explore the data and investigate the possible presence of a laboratory effect, we start by creating a scatter plot with the wound healing variable on the x-axis and the laboratory facility variable on the y-axis:\n\nggplot(data_block, aes(x = WoundHealing, y = Laboratory, color = Treatment)) +\n  geom_point(size = 4) +\n  labs(title = \"Wound Healing by Treatment and Laboratory\",\n       x = \"Wound Healing Measure\",\n       y = \"Laboratory\") +\n  theme_minimal()\n\nIn addition to the scatter plot, we compute descriptive statistics to summarize the wound healing measures within treatments and within laboratories. This will help us assess variability both across treatments and across laboratory facilities.\n\n# Summarizing data by Treatment\nsummary_stats_treatment &lt;- data_block |&gt;\n  group_by(Treatment) |&gt;\n  summarise(\n    Mean_WoundHealing = mean(WoundHealing),\n    SD_WoundHealing = sd(WoundHealing)\n  )\n\n# Summarizing data by Laboratory\nsummary_stats_laboratory &lt;- data_block |&gt;\n  group_by(Laboratory) |&gt;\n  summarise(\n    Mean_WoundHealing = mean(WoundHealing),\n    SD_WoundHealing = sd(WoundHealing)\n  )\n\n# Displaying the produced summary tables\nsummary_stats_treatment\nsummary_stats_laboratory\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nWhat patterns do you observe regarding the effects of treatment and laboratory based on the plot and summary statistics?"
  },
  {
    "objectID": "BLR_lab_randomized_block.html#a-mixed-effects-model-for-the-randomized-block-design",
    "href": "BLR_lab_randomized_block.html#a-mixed-effects-model-for-the-randomized-block-design",
    "title": "Beyond MLR Lab 2: Randomized Block Designs",
    "section": "A Mixed Effects Model for the Randomized Block Design",
    "text": "A Mixed Effects Model for the Randomized Block Design\nIn a mixed-effects model, both fixed effects and random effects are used to account for different sources of variation.\nIn the wound healing example, it is essential to account for the laboratory facility because differences between laboratories (such as variations in environmental conditions) could influence the outcome. By including laboratory as a blocking variable, we can more efficiently estimate the treatment effects by controlling for this source of variability. This can be statistically achieved by modeling laboratory as either a fixed effect or a random effect.\nWhile we could model laboratory as a fixed effect, treating it as a random effect is preferred in this case for two reasons: first, it better reflects reality, as the laboratories are considered a random sample of possible laboratory conditions; second, it reduces the number of parameters we need to estimate, making the model more parsimonious. Modeling the lab as random allows us to account for variability between laboratories without estimating a separate effect for each one, which ultimately helps to isolate the treatment effects more effectively.\nOn the other hand, treatment is modeled as a fixed effect because we are specifically interested in estimating and comparing the effectiveness of the three particular wound healing treatments (Treatment A, Treatment B, and Treatment C). These treatments are not considered random samples from a larger population of treatments; rather, they are the specific interventions under study. By modeling treatment as a fixed effect, we aim to draw conclusions about the differences between these particular treatments, and their impact on wound healing.\n\nModel Specification\nThe mixed-effects model for our randomized block design can be specified as:\n\\[\nY_{ij} = \\mu + \\tau_i + b_j + \\epsilon_{ij}\n\\]\nwhere:\n\n\\(Y_{ij}\\): The observed wound healing response for treatment \\(i\\) in laboratory \\(j\\).\n\\(\\mu\\): The overall mean response across all treatments and laboratories.\n\\(\\tau_i\\): The fixed effect of treatment \\(i\\), representing the deviation of treatment \\(i\\) from the overall mean \\(\\mu\\).\n\\(b_j\\): The random effect of laboratory \\(j\\), assumed to be normally distributed with mean zero and variance \\(\\sigma_b^2\\)).\n\\(\\epsilon_{ij}\\): The residual error term, assumed to be independent and normally distributed with mean zero and variance \\(\\sigma^2\\).\n\n\n\n\n\n\n\nNoteNotation convention\n\n\n\nIn mixed-effects models, fixed effects are typically represented by Greek letters, while random effects are represented by Roman letters. This helps differentiate between the two types of effects in model specification.\n\n\n\n\nModel Estimation\nTo fit the previously specified mixed effects model, we use the lmer() function from the lmeTest package:\n\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))  # Effects coding\ncontrasts(data_block$Treatment) # Print contrast matrix for Treatment\n\nmodel_block &lt;- lmer(WoundHealing ~ Treatment + (1 | Laboratory), data = data_block)\nsummary(model_block)\n\n\nSyntax overview\nLet’s break down the model formula WoundHealing ~ Treatment + (1 | Laboratory)\n\nWoundHealing ~ Treatment: This specifies that WoundHealing is the outcome variable and that Treatment is included as a fixed effect to estimate differences between the three treatments. Note that the intercept is included by default in the model, so WoundHealing ~ Treatment is essentially a shortcut for WoundHealing ~ 1 + Treatment. Also remember that with effects coding, the intercept represents the overall mean across all levels of the treatment variable, and the treatment coefficients represent deviations from this mean.\n(1 | Laboratory): This specifies the random effect for Laboratory, representing laboratory-specific deviations from the overall mean.\n\n\n\nSummary overview\nWhen you run summary(model_block), the output will display:\n\nFixed Effects: Estimates of the fixed effects\n\nIntercept: The overall mean wound healing score averaged across all treatments and laboratories.\nTreatment: The differences in wound healing associated with each treatment relative to the overall mean.\n\nRandom Effects: Estimates of the variance components\n\nLaboratory - Intercept: Between-laboratory variability (\\(\\sigma^2_{b}\\)).\nResidual: Residual variance (\\(\\sigma^2\\)).\n\n\n\n\n\n\n\n\nWarningCaution: Interpreting p-values in Mixed Effects Models\n\n\n\nWhile the lmerTest package provides p-values for fixed effects, it is important to use them with caution, primarily because methods for calculating degrees of freedom, such as Satterthwaite, are approximations that may not always be reliable, particularly in complex models fitted to imbalanced data. Hypothesis testing based on likelihood ratio tests may be preferred in those settings.\n\n\n\n\n\nAssessing the fixed effects\nIn addition to providing p-values for fixed effects estimates, the lmerTest package allows us to assess the overall significance of fixed effects using the anova() function. To further explore the nature of these effects, we can obtain the estimated marginal means for the factor levels in the model. Rather than using the package’s build in ls_means() function, we will use emmeans() function from the emmeans package, which provides more options and greater flexibility.\n\n# Obtain ANOVA table for the fixed effects\nanova(model_block)\n\n\n# Compute estimated marginal means for the Treatment variable\nemms &lt;- emmeans(model_block, ~ Treatment)\nemms\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nWhat does the F-test tell us about the treatment effect?\n\n\n\nPairwise comparisons\nSince we found a significant treatment effect, we proceed with computing pairwise differences of the estimated marginal means:\n\n# Perform pairwise comparisons with Bonferroni adjustment\npairs(emms, adjust = \"bonferroni\")\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nBased on the results of the pairwise comparisons, which treatment groups differ significantly?\n\n\n\n\n\nAssessing the variance components\n\n\n\n\n\n\nImportantQuestion\n\n\n\nBased on the estimated variance components from summary(model_block), calculate the intra-class correlation (ICC) and interpret its meaning.\n\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nConsidering these results, do you think that blocking by laboratory was necessary for this experiment?\n\n\n\n\nModel Diagnostics\nIn mixed-effects models, model diagnostics involve analyzing different types of residuals to evaluate how well the model fits the data and to assess whether key assumptions are satisfied.\nThe default type of residuals used in these models are the conditional residuals, which are calculated based on predicted values that incorporate both fixed effects and estimated random effects. Conditional residuals represent the deviation of the observed data from the model’s predictions, accounting for variability from both sources: fixed effects and random effects. They can be considered estimates of the errors \\(\\epsilon_{ij}\\), which are assumed to be normally distributed with a mean of zero and constant variance.\nTo check these assumptions, we can generate diagnostic plots similar to those used in linear regression models:\n\nResiduals vs. Fitted Plot: This plot helps check for homoscedasticity (constant variance).\nNormal Q-Q Plot: This plot assesses whether the residuals follow a normal distribution.\n\n\n# Extract conditional residuals\nresiduals_cond &lt;- resid(model_block)\n\n# Residuals vs Fitted\nplot(fitted(model_block), residuals_cond,\n     main = \"Residuals vs Fitted\",\n     xlab = \"Fitted values\",\n     ylab = \"Residuals\")\nabline(h = 0, col = \"red\")\n\n# Normal Q-Q Plot\nqqnorm(residuals_cond)\nqqline(residuals_cond, col = \"red\")\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nDo the diagnostic plots suggest any violations of the model assumptions regarding the error term?"
  },
  {
    "objectID": "Assignments/Week 2/Assignment_week_2.html",
    "href": "Assignments/Week 2/Assignment_week_2.html",
    "title": "Assignment Week 2: Effectiveness of Exercise Routines on Functional Mobility",
    "section": "",
    "text": "In this assignment, you will analyze a dataset that evaluates the effectiveness of different exercise routines on improving functional mobility in patients recovering from knee replacement surgery. The study uses a replicated randomized block design to account for individual variability among patients.\nEach patient participated in all three exercise routines, and each routine was performed three times. Functional mobility was assessed after each session, with scores ranging from 40 to 80 (higher scores indicate better mobility). The dataset contains 54 observations (6 patients x 3 routines x 3 replications) and is provided in the downloads section below."
  },
  {
    "objectID": "Assignments/Week 2/Assignment_week_2.html#introduction",
    "href": "Assignments/Week 2/Assignment_week_2.html#introduction",
    "title": "Assignment Week 2: Effectiveness of Exercise Routines on Functional Mobility",
    "section": "",
    "text": "In this assignment, you will analyze a dataset that evaluates the effectiveness of different exercise routines on improving functional mobility in patients recovering from knee replacement surgery. The study uses a replicated randomized block design to account for individual variability among patients.\nEach patient participated in all three exercise routines, and each routine was performed three times. Functional mobility was assessed after each session, with scores ranging from 40 to 80 (higher scores indicate better mobility). The dataset contains 54 observations (6 patients x 3 routines x 3 replications) and is provided in the downloads section below."
  },
  {
    "objectID": "Assignments/Week 2/Assignment_week_2.html#dataset-description",
    "href": "Assignments/Week 2/Assignment_week_2.html#dataset-description",
    "title": "Assignment Week 2: Effectiveness of Exercise Routines on Functional Mobility",
    "section": "Dataset Description",
    "text": "Dataset Description\nThe dataset consists of the following variables:\n\nPatient: A numeric variable representing individual patients (blocks).\nExerciseRoutine: A factor variable representing the type of exercise routine:\n\nA: Low-impact walking exercises.\nB: Resistance training exercises.\nC: Balance and flexibility exercises.\n\nFunctionalMobility: A numeric variable (40-80) representing the mobility score measured after each session."
  },
  {
    "objectID": "Assignments/Week 2/Assignment_week_2.html#objective",
    "href": "Assignments/Week 2/Assignment_week_2.html#objective",
    "title": "Assignment Week 2: Effectiveness of Exercise Routines on Functional Mobility",
    "section": "Objective",
    "text": "Objective\nYour goal is to determine:\n\nWhether there are significant differences in functional mobility scores between the three exercise routines.\nHow much of the variability in mobility scores can be attributed to:\n\nDifferences between patients.\nDifferences between exercise routines.\nResidual variability (within patient-treatment combinations).\n\n\nTo complete this analysis, follow the detailed steps outlined below."
  },
  {
    "objectID": "Assignments/Week 2/Assignment_week_2.html#steps-to-complete-the-analysis",
    "href": "Assignments/Week 2/Assignment_week_2.html#steps-to-complete-the-analysis",
    "title": "Assignment Week 2: Effectiveness of Exercise Routines on Functional Mobility",
    "section": "Steps to Complete the Analysis",
    "text": "Steps to Complete the Analysis\n\n1. Load the dataset\nWhen loading the dataset in R, ensure that the ExerciseRoutine variable is treated as a factor. One way to achieve this is by specifying the column type explicitly using the colClasses argument in the read.csv() function. For example:\n\n# Load the dataset and specify ExerciseRoutine as a factor\ndataset &lt;- read.csv(\"functional_mobility.csv\", colClasses = c(\"ExerciseRoutine\" = \"factor\"))\n\n\n\n2. Perform an Exploratory Data Analysis (EDA)\n\nVisualize the data using an interaction plot.\nCalculate descriptive statistics for each exercise routine and patient.\n\n\n\n3. Fit a Mixed-Effects Model\n\nFit a mixed-effects model with:\n\nFixed Effects: ExerciseRoutine (to estimate differences between exercise routines).\nRandom Effects:\n\nPatient (to account for variability between individuals).\nPatient × ExerciseRoutine (to account for potential variability in how patients respond to different routines).\n\n\nTest whether the Patient × ExerciseRoutine random interaction term is necessary by comparing the full model (with the interaction term) to a reduced model (without the interaction term).\nBased on the results of this test:\n\nIf the interaction term is significant, proceed with the full model for further analysis.\nIf the interaction term is not significant, proceed with the reduced model.\n\nSummarize the chosen model:\n\nReport the fixed effects and variance components.\n\n\n\n\n4. Test for Overall Differences\n\nUse the selected model to test for overall differences in functional mobility scores across exercise routines.\n\n\n\n5. Perform Pairwise Comparisons\n\nIf significant overall differences are found, calculate estimated marginal means and perform pairwise comparisons to identify which routines differ.\n\n\n\n6. Evaluate Model Assumptions\n\nAssess the model’s assumptions (e.g., normality of residuals, homoscedasticity) using diagnostic plots."
  },
  {
    "objectID": "Assignments/Week 2/Assignment_week_2.html#requirements-for-the-report",
    "href": "Assignments/Week 2/Assignment_week_2.html#requirements-for-the-report",
    "title": "Assignment Week 2: Effectiveness of Exercise Routines on Functional Mobility",
    "section": "Requirements for the Report",
    "text": "Requirements for the Report\nSubmit both the Quarto source file (.qmd) and the rendered HTML file. The quarto source file should include all R code and annotations, and the html file should be rendered with code visibility enabled (echo = TRUE)."
  },
  {
    "objectID": "Assignments/Week 2/Assignment_week_2.html#downloads",
    "href": "Assignments/Week 2/Assignment_week_2.html#downloads",
    "title": "Assignment Week 2: Effectiveness of Exercise Routines on Functional Mobility",
    "section": "Downloads",
    "text": "Downloads\nDownload dataset"
  },
  {
    "objectID": "Assignments/Week 4/Assignment_week_4.html",
    "href": "Assignments/Week 4/Assignment_week_4.html",
    "title": "Assignment Week 4: Longitudinal Data Analysis",
    "section": "",
    "text": "You will work with longitudinal data from a growth curve study. The dataset captures weight measurements of 568 Asian children, recorded during clinic visits on up to five occasions. Ages range from approximately 6 weeks to 27 months. Your task is to model the children’s growth trajectories over time.\nThis dataset was sourced from the data library of the centre for Multilevel Modelling, University of Bristol."
  },
  {
    "objectID": "Assignments/Week 4/Assignment_week_4.html#introduction",
    "href": "Assignments/Week 4/Assignment_week_4.html#introduction",
    "title": "Assignment Week 4: Longitudinal Data Analysis",
    "section": "",
    "text": "You will work with longitudinal data from a growth curve study. The dataset captures weight measurements of 568 Asian children, recorded during clinic visits on up to five occasions. Ages range from approximately 6 weeks to 27 months. Your task is to model the children’s growth trajectories over time.\nThis dataset was sourced from the data library of the centre for Multilevel Modelling, University of Bristol."
  },
  {
    "objectID": "Assignments/Week 4/Assignment_week_4.html#dataset-description",
    "href": "Assignments/Week 4/Assignment_week_4.html#dataset-description",
    "title": "Assignment Week 4: Longitudinal Data Analysis",
    "section": "Dataset description",
    "text": "Dataset description\nThe dataset consists of the following variables:\n\nChildID: Unique identifier for each child\nAge: Child’s age at the time of measurement (months)\nWeight: Child’s weight at the time of measurement (grams)\nGender: Child’s gender (Boy or Girl)"
  },
  {
    "objectID": "Assignments/Week 4/Assignment_week_4.html#objectives",
    "href": "Assignments/Week 4/Assignment_week_4.html#objectives",
    "title": "Assignment Week 4: Longitudinal Data Analysis",
    "section": "Objectives",
    "text": "Objectives\nYour objectives are to:\n\nDevelop an appropriate model to describe the growth curve of children’s weight over time, considering fixed and random effects.\nUse the model to answer the following research questions:\n\nHow does the weight of children change over time (e.g., constant, linear, quadratic)?\nHow does gender influence the mean growth curve of children’s weight?"
  },
  {
    "objectID": "Assignments/Week 4/Assignment_week_4.html#steps-to-complete-the-analysis",
    "href": "Assignments/Week 4/Assignment_week_4.html#steps-to-complete-the-analysis",
    "title": "Assignment Week 4: Longitudinal Data Analysis",
    "section": "Steps to complete the analysis",
    "text": "Steps to complete the analysis\n\nLoad the dataset\nDownload the dataset (see link in the Downloads section below) and read it into R. Ensure that the Gender variable is correctly encoded as a factor.\n\n\nExploratory data analysis\n\nExplore the individual and mean trajectories of weight gain over time.\n\n\n\nModel building\n\nBegin with a comprehensive (saturated) model and iteratively simplify it to determine the best fixed and random effects structure.\nUse likelihood ratio tests to refine random effects (models not refitted with ML).\nUse likelihood ratio tests with models refitted using ML to refine fixed effects.\n\n\n\nInterpret the results\nInterpret the findings from your analysis, focusing on answering the research questions outlined in the Objectives section."
  },
  {
    "objectID": "Assignments/Week 4/Assignment_week_4.html#requirements-for-the-report",
    "href": "Assignments/Week 4/Assignment_week_4.html#requirements-for-the-report",
    "title": "Assignment Week 4: Longitudinal Data Analysis",
    "section": "Requirements for the report",
    "text": "Requirements for the report\nYour report should clearly explain:\n\nThe reasoning behind your choice of model structure.\nThe interpretation of key model parameters in the context of the research questions.\nAny limitations or assumptions affecting your analysis.\n\nSubmit both the Quarto source file (.qmd) and the rendered HTML file. Ensure that the HTML file includes visible code (echo = TRUE) for reproducibility."
  },
  {
    "objectID": "Assignments/Week 4/Assignment_week_4.html#downloads",
    "href": "Assignments/Week 4/Assignment_week_4.html#downloads",
    "title": "Assignment Week 4: Longitudinal Data Analysis",
    "section": "Downloads",
    "text": "Downloads\nDownload dataset"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html",
    "href": "BLR_lab_two_way_factorial.html",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "",
    "text": "NotePreliminary setup\n\n\n\nIn this lab, we will use the R packages ggplot2, dplyr, and emmeans. You can use the script below to automatically install and load them using the pacman package.\n\n# Check whether pacman is available and install if needed\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\n\n# Use pacman to install (if needed) and load the required packages\npacman::p_load(dplyr, ggplot2, emmeans)"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#exploratory-data-analysis",
    "href": "BLR_lab_two_way_factorial.html#exploratory-data-analysis",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Exploratory Data Analysis",
    "text": "Exploratory Data Analysis\nTo understand how recovery rates vary across therapy type and disease severity, we start by creating an interaction plot showing the mean recovery rate for each combination:\n\n# Visualizing the results\nggplot(data_twoway, aes(x = Therapy, y = RecoveryRate, color = Severity, group = Severity)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  labs(title = NULL,\n       x = \"Therapy Type\", \n       y = \"Mean recovery rate (%)\",\n       color = \"Disease Severity\") +\n  theme_minimal()\n\nWe also calculate summary statistics for each combination of therapy type and disease severity:\n\n# Generating summary statistics by Therapy and Severity\nsummary_stats &lt;- data_twoway |&gt;\n  group_by(Therapy, Severity) |&gt;\n  summarise(\n    n = n(),\n    Mean_RecoveryRate = mean(RecoveryRate),\n    SD_RecoveryRate = sd(RecoveryRate),\n    .groups = \"drop\"\n  )\nsummary_stats\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nBased on the plot and summary statistics, does there appear to be an interaction between therapy type and disease severity?"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#performing-a-two-way-factorial-anova",
    "href": "BLR_lab_two_way_factorial.html#performing-a-two-way-factorial-anova",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Performing a Two-Way Factorial ANOVA",
    "text": "Performing a Two-Way Factorial ANOVA\n\nModel Specification\nUsing effects coding, the two-way factorial Analysis of Variance (ANOVA) model can be specified as:\n\\[\nY_{ijk} = \\mu + \\alpha_i + \\beta_j + (\\alpha\\beta)_{ij} + \\epsilon_{ijk}\n\\]\nwhere:\n\n\\(Y_{ijk}\\): The change in body weight for the \\(k\\)-th participant with exercise level \\(i\\) and diet type \\(j\\).\n\\(\\mu\\): The grand mean (overall average change in body weight across all groups).\n\\(\\alpha_i\\): The main effect of exercise level \\(i\\), representing the deviation from the grand mean. Constraint: \\(\\sum_i \\alpha_i = 0\\).\n\\(\\beta_j\\): The main effect of diet type \\(j\\), representing the deviation from the grand mean. Constraint: \\(\\sum_j \\beta_j = 0\\).\n\\((\\alpha\\beta)_{ij}\\): The interaction effect between exercise level \\(i\\) and diet type \\(j\\), representing the deviation from additivity. Constraint: \\(\\sum_i (\\alpha\\beta)_{ij} = \\sum_j (\\alpha\\beta)_{ij} = 0\\).\n\\(\\epsilon_{ijk}\\): The residual error term, assumed to be independent and normally distributed with mean zero and constant variance.\n\n\n\n\n\n\n\nNoteCoding schemes for categorical variables\n\n\n\nIn two-way ANOVA, effects coding is preferred because it allows interpretation of group differences relative to the grand mean rather than a reference category. With effects coding, all group means can be expressed as combinations of the grand mean and deviations for each main effect and their interaction.\nTo use effects coding globally:\n\n# Set effects coding as the default coding scheme for unordered (nominal) factors\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))\n\n\n\n\n\nModel Estimation\nWe can fit the two-way ANOVA model using the lm() function. The key feature of the model formula is the interaction term (specified using *), which includes both main effects and their interaction:\n\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))  # Effects coding\n\n# Fit the two-way ANOVA model with interaction\nmodel_twoway &lt;- lm(StemLength ~ Fertilizer * Watering, data = data_twoway)\nsummary(model_twoway)\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nHow do the estimated coefficients relate to the cell means and the grand mean?\n\n\n\n\nANOVA Table and Global Hypothesis Tests\nTo test whether the main effects and interaction are statistically significant, we use the anova() function to obtain the ANOVA table:\n\n# ANOVA table\nanova_results &lt;- anova(model_twoway)\nanova_results\n\nThe ANOVA table tests three global hypotheses:\n\nNo interaction: \\(H_0\\!:\\,(\\alpha\\beta)_{ij}=0\\) for all \\(i,j\\)\nNo main effect of Exercise: \\(H_0\\!:\\,\\alpha_i=0\\) for all \\(i\\)\nNo main effect of Diet: \\(H_0\\!:\\,\\beta_j=0\\) for all \\(j\\)\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nWhat do the F-tests and p-values in the ANOVA table tell us about the significance of the interaction and main effects?\n\n\n\n\nRecipe for Interpretation\nThe next steps depend on whether the interaction is significant:\nIf the interaction is NOT significant: Examine the main effects by computing marginal means (average effect of each factor across all levels of the other factor).\nIf the interaction IS significant: Examine simple effects by computing conditional means (effect of one factor within each level of the other factor).\nIn this example, we will assume the interaction is not significant and proceed with examining the main effects.\n\n\nEstimated Marginal Means\nWhen the interaction is not significant, we examine the marginal means (average effects) for each factor:\n\n# Compute marginal means for Fertilizer\nemm_fertilizer &lt;- emmeans(model_twoway, ~ Fertilizer)\nemm_fertilizer\n\n# Compute marginal means for Watering\nemm_watering &lt;- emmeans(model_twoway, ~ Watering)\nemm_watering\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nHow do the marginal means for each fertilizer type compare to each other? How do they compare to the observed cell means?\n\n\n\n\nPairwise Comparisons for Main Effects\nSince Fertilizer has three levels and we found a significant main effect, we conduct pairwise comparisons among fertilizer types to identify which specific types differ significantly. We apply the Bonferroni correction to control for multiple comparisons:\n\n# Pairwise comparisons for Fertilizer with Bonferroni adjustment\npairs(emm_fertilizer, adjust = \"bonferroni\")\n\nSince Watering has only two levels, pairwise comparisons are less informative but can still be computed if needed.\n\n\n\n\n\n\nImportantQuestion\n\n\n\nBased on the pairwise comparisons, which fertilizer types differ significantly from one another?\n\n\n\n\nModel Diagnostics\nTo assess the adequacy of the fitted model, we create two diagnostic plots:\n\nResiduals vs Fitted Plot: Used to assess homoscedasticity (constant variance). A random scatter around zero suggests equal variance.\nNormal Q-Q Plot: Used to assess normality of the errors. Points following the reference line suggest normally distributed residuals.\n\n\n# Residuals vs Fitted\nplot(model_twoway, which = 1, main = \"Residuals vs Fitted\")\n\n# Normal Q-Q\nplot(model_twoway, which = 2, main = \"Normal Q-Q\")\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nDo the diagnostic plots suggest any violations of the model assumptions?\n\n\n\n\nReporting\nA two-way factorial ANOVA showed no significant interaction between fertilizer type and watering frequency, F(2, 54) = 1.18, p = 0.315. There were significant main effects of both fertilizer type and watering frequency on stem length. For fertilizer type, the estimated marginal means (95% CI) were 30.0 (29.2, 30.8) cm for the synthetic fertilizer, 26.5 (25.7, 27.3) cm for the organic fertilizer, and 20.0 (19.2, 20.8) cm for the control group. Bonferroni-adjusted pairwise comparisons indicated that all fertilizer types differed significantly from one another (p &lt; 0.001 for all comparisons). For watering frequency, the estimated marginal means (95% CI) were 28.3 (27.7, 28.9) cm for daily watering and 23.5 (22.9, 24.1) cm for weekly watering, with a significant difference between the two frequencies (p &lt; 0.001)."
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#exploratory-data-analysis-1",
    "href": "BLR_lab_two_way_factorial.html#exploratory-data-analysis-1",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Exploratory Data Analysis",
    "text": "Exploratory Data Analysis\n\n# Visualizing the interaction\nggplot(data_interaction, aes(x = StudentLevel, y = TestScore, color = TeachingMethod, group = TeachingMethod)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  labs(title = NULL,\n       x = \"Student Skill Level\", \n       y = \"Mean test score\",\n       color = \"Teaching Method\") +\n  theme_minimal()\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nLooking at the plot, do the lines appear to be parallel (suggesting no interaction) or do they cross or diverge (suggesting an interaction)?"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#anova-table-for-the-interaction-example",
    "href": "BLR_lab_two_way_factorial.html#anova-table-for-the-interaction-example",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "ANOVA Table for the Interaction Example",
    "text": "ANOVA Table for the Interaction Example\n\n# Fit the model with interaction\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))  # Effects coding\nmodel_interaction &lt;- lm(TestScore ~ StudentLevel * TeachingMethod, data = data_interaction)\n\n# ANOVA table\nanova(model_interaction)\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nIs the interaction effect significant? What does this tell us about the relationship between student skill level and teaching method?"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#simple-effects-analysis",
    "href": "BLR_lab_two_way_factorial.html#simple-effects-analysis",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Simple Effects Analysis",
    "text": "Simple Effects Analysis\nBecause thew interaction effect is significant, we proceed with examing the simple effects: the effect of one factor within each level of the other factor. In this case, we examine the effect of therapy type (Standard vs Enhanced vs Control) separately for each disease severity level:\n\n# Compute simple effects: effect of therapy type within each severity level\nse_severity &lt;- emmeans(model_twoway, ~ Therapy | Severity)\nse_severity\n\nTo test which simple effects are significant, we perform pairwise comparisons within each severity level (using the Bonferroni correction to adjust for multiplicity):\n\n# Pairwise comparisons (Therapy types) within each disease severity level\nse_pairs &lt;- pairs(se_severity, adjust = \"bonferroni\")\nse_pairs\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nFor which disease severity level(s) does therapy type have a significant effect on recovery rate? What is the practical interpretation of this finding?\n\n\n\nModel Diagnostics\nTo assess the adequacy of the fitted model, we create two diagnostic plots:\n\nResiduals vs Fitted Plot: Used to assess homoscedasticity (constant variance). A random scatter around zero suggests equal variance.\nNormal Q-Q Plot: Used to assess normality of the errors. Points following the reference line suggest normally distributed residuals.\n\n\n# Residuals vs Fitted\nplot(model_twoway, which = 1, main = \"Residuals vs Fitted\")\n\n# Normal Q-Q\nplot(model_twoway, which = 2, main = \"Normal Q-Q\")\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nDo the diagnostic plots suggest any violations of the model assumptions?"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#model-diagnostics-for-the-interaction-model",
    "href": "BLR_lab_two_way_factorial.html#model-diagnostics-for-the-interaction-model",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Model Diagnostics for the Interaction Model",
    "text": "Model Diagnostics for the Interaction Model\n\n# Residuals vs Fitted\nplot(model_interaction, which = 1, main = \"Residuals vs Fitted\")\n\n# Normal Q-Q\nplot(model_interaction, which = 2, main = \"Normal Q-Q\")\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nDo the diagnostic plots suggest any violations of model assumptions?"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#reporting-the-interaction-results",
    "href": "BLR_lab_two_way_factorial.html#reporting-the-interaction-results",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Reporting the Interaction Results",
    "text": "Reporting the Interaction Results\nA two-way factorial ANOVA showed a significant interaction between student skill level and teaching method, F(2, 54) = 12.45, p &lt; 0.001. The effect of teaching method on test scores depends on the student’s skill level. Specifically, simple effects analysis revealed that teaching method significantly affected test scores for novice students, with hands-on instruction producing higher scores (mean difference = 12.95, 95% CI [10.18, 15.72], p &lt; 0.001). Teaching method also had a marginally significant effect for intermediate students (mean difference = 4.32, 95% CI [1.55, 7.09], p = 0.039), with hands-on instruction again producing higher scores. However, for advanced students, teaching method had no significant effect on test scores (mean difference = −0.88, 95% CI [−3.65, 1.89], p = 0.734)."
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#two-way-factorial-anova-model",
    "href": "BLR_lab_two_way_factorial.html#two-way-factorial-anova-model",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Two-Way Factorial ANOVA Model",
    "text": "Two-Way Factorial ANOVA Model\n\nModel Specification\nUsing effects coding, the two-way factorial Analysis of Variance (ANOVA) model can be specified as:\n\\[\nY_{ijk} = \\mu + \\alpha_i + \\beta_j + (\\alpha\\beta)_{ij} + \\epsilon_{ijk}\n\\]\nwhere:\n\n\\(Y_{ijk}\\): The recovery rate for the \\(k\\)-th patient with therapy type \\(i\\) and disease severity level \\(j\\).\n\\(\\mu\\): The grand mean (overall average recovery rate across all groups).\n\\(\\alpha_i\\): The main effect of therapy type \\(i\\), representing the deviation from the grand mean. Constraint: \\(\\sum_i \\alpha_i = 0\\).\n\\(\\beta_j\\): The main effect of disease severity level \\(j\\), representing the deviation from the grand mean. Constraint: \\(\\sum_j \\beta_j = 0\\).\n\\((\\alpha\\beta)_{ij}\\): The interaction effect between therapy type \\(i\\) and severity level \\(j\\), representing the deviation from additivity. Constraint: \\(\\sum_i (\\alpha\\beta)_{ij} = \\sum_j (\\alpha\\beta)_{ij} = 0\\).\n\\(\\epsilon_{ijk}\\): The residual error term, assumed to be independent and normally distributed with mean zero and constant variance.\n\n\n\nModel Estimation\nWe can fit the two-way ANOVA model using the lm() function. The key feature of the model formula is the interaction term (specified using *), which includes both main effects and their interaction:\n\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))  # Effects coding\n\n# Fit the two-way ANOVA model with interaction\nmodel_twoway &lt;- lm(RecoveryRate ~ Therapy * Severity, data = data_twoway)\nsummary(model_twoway)\n\n\n\nANOVA Table and Global Hypothesis Tests\nTo test whether the main effects and interaction are statistically significant, we use the anova() function to obtain the ANOVA table:\n\n# ANOVA table\nanova_results &lt;- anova(model_twoway)\nanova_results\n\nThe ANOVA table tests three global hypotheses:\n\nNo interaction: \\(H_0\\!:\\,(\\alpha\\beta)_{ij}=0\\) for all \\(i,j\\)\nNo main effect of Therapy: \\(H_0\\!:\\,\\alpha_i=0\\) for all \\(i\\)\nNo main effect of Severity: \\(H_0\\!:\\,\\beta_j=0\\) for all \\(j\\)\n\n\n\n\n\n\n\nImportantQuestion\n\n\n\nWhat do the F-tests and p-values in the ANOVA table tell us about the significance of the interaction and main effects?"
  },
  {
    "objectID": "BLR_lab_two_way_factorial.html#reporting-the-results",
    "href": "BLR_lab_two_way_factorial.html#reporting-the-results",
    "title": "Beyond MLR Lab 3: Two-Way Factorial ANOVA",
    "section": "Reporting the Results",
    "text": "Reporting the Results\nA two-way factorial ANOVA showed a significant interaction between therapy type and disease severity, F(2, 54) = 10.82, p &lt; 0.001. The effect of rehabilitation therapy type on post-stroke recovery rate depends on disease severity. Specifically, simple effects analysis revealed that therapy type significantly affected recovery rate for patients with mild disease (p &lt; 0.001), with enhanced therapy producing the highest recovery rate (mean = 72%, 95% CI [68.1, 75.9]) compared to standard therapy (mean = 45%, 95% CI [41.1, 48.9]). For patients with severe disease, therapy type also showed a significant effect (p = 0.002), but the differences were smaller, with enhanced therapy (mean = 58%, 95% CI [54.1, 61.9]) outperforming standard therapy (mean = 42%, 95% CI [38.1, 45.9]). Control therapy showed minimal recovery in both severity groups (mild: mean = 20%, severe: mean = 18%), with no significant difference between severity levels (p = 0.712)."
  }
]